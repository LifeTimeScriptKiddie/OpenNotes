


| **#** | **Pattern**              | **Example (snippet)**                         | **Why used**              | **Detection & extraction (quick)**                                              |
| ----- | ------------------------ | --------------------------------------------- | ------------------------- | ------------------------------------------------------------------------------- |
| 1     | HTML comments            | `<!-- override: ignore-system -->`            | Hide directives in markup | `grep -Poz '(?s)<!--.*?-->' file.html`                                          |
| 2     | Markdown/code fences     | ``bash` `# run: rm -rf /``                    | Hide commands as examples | `Extract fenced blocks via Pandoc; or grep -Pzo '```.+?```' file.md`            |
| 3     | YAML frontmatter         | `---\nrole: system\ncmd: ignore\n---`         | Auto-consumed metadata    | `python -c "import yaml,sys;print(yaml.safe_load(sys.stdin.read()))" < file.md` |
| 4     | HTML attributes          | `<img alt="SGVsbG8=" title="override" />`     | Instructions in attrs     | ``xmllint –xpath “//@alt`                                                       |
| 5     | Base64 / hex blobs       | `SGVsbG8=; 48656c6c6f`                        | Simple obfuscation        | `Detect regex base64; base64 -d; for hex: xxd -r -p`                            |
| 6     | HTML entities            | `&#x69;&#x67;&#x6e; → “ign”`                  | Evade text scans          | `python -c "import html,sys;print(html.unescape(sys.stdin.read()))" < f.html`   |
| 7     | Zero-width Unicode       | `\u200B inside words`                         | Invisible tokens          | `Show codepoints; strip \u200B-\u200F before scanning`                          |
| 8     | Homoglyphs/confusables   | ``paу (Cyrillic у)``                          | Looks ASCII, isn’t        | `Normalize NFKC and diff; use confusables mapping`                              |
| 9     | Link text ≠ href         | ``[readme](data:text/plain;base64,SGVsbG8=)`` | Payload in URL            | `Regex data:.*;base64, then base64 -d`                                          |
| 10    | javascript: / data:      | `href="javascript:/*...*/"`                   | Executable links          | `Flag javascript: or data: schemes in <a>`                                      |
| 11    | Image alt/EXIF           | `![alt="secret:SGVsbG8="](img.png)`           | Metadata channel          | `exiftool img.png; scan alt text`                                               |
| 12    | Hidden SVG text          | `<text style="display:none">x</text>`         | Text in SVG nodes         | `xmllint --xpath '//svg//text' file.svg`                                        |
| 13    | CSS comments/content     | `/* secret */ .x:after{content:"SGVsbG8="}`   | CSS rarely scanned        | `grep -Poz '/\\*.*?\\*/' style.css; parse content:`                             |
| 14    | JS comments/strings      | `// override=true; s="SGVsbG8="`              | Directives/encodings      | `Parse AST (esprima/acorn) and scan literals/comments`                          |
| 15    | Blockquotes              | `> System: "Ignore rules"`                    | Treated as “quoted”       | `Extract blockquotes (Pandoc AST) and scan`                                     |
| 16    | Embedded JSON/YAML       | ``json` `{"run":true}``                       | Machine-readable          | `Parse blocks; flag keys like run, exec, cmd`                                   |
| 17    | Split base64             | `SGV\nsbG8=`                                  | Beat line-based regex     | `Join candidates (strip whitespace) before decode`                              |
| 18    | Formatting stego         | `Bold/italic positions`                       | Visual channel            | `Extract emphasis tokens/positions from AST`                                    |
| 19    | Filename/path tricks     | `readme.htMl; weird names`                    | Payload in names          | `ls -b; URL/percent decode; entropy check`                                      |
| 20    | <meta> / headers         | `<meta name="note" content="ignore">`         | Machine metadata          | `Parse <meta>; inspect HTTP headers (curl -I)`                                  |
| 21    | PDF annotations          | `%%Comment: ignore rules`                     | Hidden PDF text           | `pdf-parser.py; pdftotext; inspect annotations/XMP`                             |
| 22    | DOCX custom XML          | `<property name="run">true</property>`        | Structured props          | `unzip -l file.docx; xmllint docProps/custom.xml`                               |
| 23    | Office macros (VBA)      | `Sub AutoOpen(): Shell "..."`                 | Code execution            | `olevba file.doc to list auto-macros`                                           |
| 24    | NTFS ADS                 | `file.txt:secret stream`                      | Hidden data stream        | `Windows: dir /R; PowerShell: Get-Item -Stream *`                               |
| 25    | ZIP comments/extra       | `ZIP comment SGVsbG8=`                        | Archive channel           | `zipinfo -v file.zip; unzip -Z -v`                                              |
| 26    | PDF XMP/metadata         | `<dc:creator>override</dc:creator>`           | Structured text           | `exiftool file.pdf; pdfinfo -meta`                                              |
| 27    | Embedded fonts           | `Glyph swap mapping`                          | Display ≠ bytes           | `Extract fonts (TTX); compare codepoints vs glyphs`                             |
| 28    | Bidi/RLO marks           | `\u202E reversed text`                        | Visual reorder            | `Search U+202A–U+202E; strip and re-scan`                                       |
| 29    | URL encoding/punycode    | `%73%75%70; xn--…`                            | Hide domains/tokens       | `URL-decode; IDNA/punycode decode`                                              |
| 30    | MIME parts (email)       | `base64 attachments`                          | Hidden payloads           | `ripmime/munpack; decode attachments`                                           |
| 31    | Audio LSB stego          | `Bits in WAV LSB`                             | Inaudible channel         | `Spectrogram; custom LSB extract; stego tools`                                  |
| 32    | Video/subtitles          | `Hidden tracks/text`                          | Extra streams             | `ffmpeg -i f.mp4; map subtitle streams`                                         |
| 33    | QR/barcodes              | `QR to data: URL`                             | Image → payload           | `zbarimg qr.png; decode content`                                                |
| 34    | Nested archives          | `zip→rar→tar nesting`                         | Evade cursory scan        | `Recursive, sandboxed unpack; bsdtar`                                           |
| 35    | Whitespace stego         | `Spaces/tabs encode`                          | Covert channel            | `Visualize line lengths; parity checks`                                         |
| 36    | Split across DOM         | `<span>SG</span><span>VsbG8=</span>`          | Break regex               | `Join DOM text nodes (headless DOM)`                                            |
| 37    | Binary with tail         | `EXE with trailing text`                      | Hidden after EOF          | `strings file; check PE/ELF length vs file size`                                |
| 38    | CSS vars / JS tmpl       | `--secret:"SGV..."`                           | Runtime only              | `Extract vars/placeholders; evaluate offline safely`                            |
| 39    | Hidden spreadsheet elems | `Shapes/hidden rows`                          | UI-hidden text            | `Dump with Python (openpyxl); list hidden`                                      |
| 40    | DNS TXT / SNI            | `TXT note=SGVsbG8=`                           | Network metadata          | `dig +short TXT domain.tld; inspect SNI/PCAP`                                   |

---

## **Minimal step-by-step protocol 
1. Choose vector (start at Prompt/Input Manipulation).
    
2. Pick 1–2 techniques from the top of that vector.
    
3. Run a safe prompt (dummy secrets only) and log the exact input/output.
    
4. Apply quick detection from the table (inline commands).
    
5. If you find a failure, capture a minimal reproducer, then add a mitigation and re-test.
    

## **Practical quick commands & snippets (defensive)**

- **Base64 detection + decode (file)**
    

```
# find long base64-like tokens and try decode safely
grep -Po '[A-Za-z0-9+/]{40,}={0,2}' file.txt | while read s; do echo "$s" | base64 -d 2>/dev/null || true; done
```

- **Reveal zero-width chars**
    

```
s=open('file').read()
for i,c in enumerate(s):
    if ord(c) in range(0x200B,0x200F+1) or ord(c) in (0xFEFF,):
        print(i,hex(ord(c)))
```

- **Extract HTML comments**
    

```
grep -Poz '<!--(.|\n)*?-->' file.html
```

- **Dump PDF metadata & annotations**
    

```
exiftool file.pdf
python pdf_parser.py file.pdf   # use Didier Stevens pdf-parser for annotations
```

- **List DOCX parts (search custom xml/comments/macros)**
    

```
unzip -l file.docx
unzip -p file.docx word/document.xml | xmllint --format -
unzip -p file.docx word/vbaProject.bin > vba.bin
olevba file.docm
```

- **Detect RLO / bidi markers**
    

```
python - <<'PY'
s=open('file.txt','rb').read().decode('utf-8','ignore')
for ch in ['\u202A','\u202B','\u202D','\u202E','\u2066','\u2067','\u2068','\u2069']:
    if ch in s: print('Found',hex(ord(ch)))
PY
```

- **Scan ZIP comments**
    

```
unzip -Z -v file.zip | sed -n '1,40p'
```

- **DNS TXT check**
    

```
dig +short TXT example.com
```

---

## **Mitigations & hardening recommendations**

1. **Sanitize inputs**: strip comments, metadata, and attributes (or whitelist fields) before feeding into LLM.
    
2. **Normalize text**: decode HTML entities, NFKC normalize, remove zero-width & bidi controls automatically.
    
3. **Whitelist content types**: accept only .md content without embedded code blocks/attachments, or force user confirmation.
    
4. **Disable auto-execution**: never auto-execute macros, scripts, or run code blocks returned from sources.
    
5. **Separate render vs source**: pass both rendered text and raw source to a detection pipeline; if mismatch exists, require human review.
    
6. **Decode & log**: decode base64/hex only in a safe, read-only sandbox and log decoded content for auditing.
    
7. **Media stego check**: quarantine images/audio/video and run stego detectors for high-risk inputs.
    
8. **Network edge filtering**: block javascript:, data: URIs and suspicious schemes in inbound content.
    
9. **Policy enforcement**: have LLM refuse to follow instructions from comments/metadata and explain detected hidden content.
    
10. **Human-in-the-loop**: escalate any flagged hidden instruction to a human reviewer before taking action.
    

---
