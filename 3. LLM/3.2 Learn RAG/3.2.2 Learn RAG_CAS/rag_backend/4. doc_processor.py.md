---
dg-publish: true
---

==`doc_processor.py --> formerly pdf_utils.py`==

# `pdf_utils.py`Â Breakdown

Handles PDF preprocessing for a RAG pipeline using Docling, ChromaDB, and optional OCR fallback.

---

##  Active Functionality

### `build_vectordb_from_pdf(pdf_path: Path) -> Chroma`

```python
loader = DoclingLoader(file_path=[str(pdf_path)], export_type=ExportType.DOC_CHUNKS)
docs = loader.load()
embeddings = OllamaEmbeddings(model="nomic-embed-text")
vectordb = Chroma.from_documents(docs, embeddings)
```

|Component|Description|
|---|---|
|`DoclingLoader`|Parses PDF and returns semantic document chunks|
|`OllamaEmbeddings`|Embeds chunks using local LLM via Ollama|
|`Chroma.from_documents()`|Stores embedded chunks in a persistent vector database|

---

### `ocr_pdf(input_path: Path, output_path: Path) -> bool`

```python
subprocess.run(["ocrmypdf", str(input_path), str(output_path)], check=True)
```

|Purpose|Makes image-based PDFs searchable usingÂ `ocrmypdf`|
|---|---|
|Input|Scanned or non-text PDFs|
|Output|OCRâ€™d PDF with embedded text|
|Tool Used|`ocrmypdf`Â via system call|

---

## Deprecated / Commented-Out Sections

### `extract_text_from_pdf()`

- UsesÂ `PyPDF2`Â to extract text
    
- Falls back to OCR if no text is found
    
- Replaced byÂ `DoclingLoader`
    

---

### `split_text_into_chunks()`

- UsesÂ `RecursiveCharacterTextSplitter`Â to split raw text
    
- Replaced by Docling's built-in chunking
    

---

##  Summary Table

|Function|Role|Status|
|---|---|---|
|`build_vectordb_from_pdf()`|Chunk + embed + store in ChromaDB|âœ… Active|
|`ocr_pdf()`|OCR fallback for scanned PDFs|âœ… Active|
|`extract_text_from_pdf()`|Text extraction + fallback OCR|ðŸ’¤ Legacy|
|`split_text_into_chunks()`|Text chunking via LangChain|ðŸ’¤ Legacy|

